<chapter id="setup">
	<title>Setting up the build environment</title>
	
	<section>
		<title>Get the latest build system from CVS</title>
		<para>You can use these commands to checkout jbosside releng from jboss' anonymous cvs:</para>
		<programlisting>$ cvs -d:pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss login</programlisting>
		<para>You will be prompted for a password, which you should just leave blank and press "Enter".</para>
		<programlisting>$ cvs -d:pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss co jbosside/releng/org.jboss.ide.eclipse.releng</programlisting>
	</section>
	
	<section>
		<title>Run the build customization script</title>
		<para>There are two targets in this script, depending on how you plan on running the JBossIDE Build system.</para>
		<itemizedlist>
			<listitem><link linkend="swing-customization">Swing based GUI Customization (most users)</link></listitem>
			<listitem><link linkend="properties-customization">Properties-file Customization (sysadmins, cruisecontrol)</link></listitem>
		</itemizedlist>
	</section>
	
	<section id="swing-customization">
		<title>Swing based GUI Customization (most users)</title>
		<itemizedlist>
			<listitem>
				<para>You will need to run the customizeBuild.xml with a recent version of Ant (tested w/ 1.6.5) like so:</para>
				<programlisting>ant -f customizeBuild.xml</programlisting>
				
				<para>The dialog you receive should look something like this:</para>
	            <mediaobject>
	                <imageobject>
	                    <imagedata align="center" fileref="images/gui.jpg"/>
	                </imageobject>
	            </mediaobject>
				
				<para>Here's a breakdown of the fields and what they mean:</para>
				<informaltable>
					<tgroup cols="2" align="left" valign="top" colsep="0" rowsep="0">
						<tbody>
							<row>
								<entry><emphasis role="bold">Location of eclipse zip binaries</emphasis></entry>
								<entry>This should be a directory where the various binary zip distributions of eclipse live. By default, the build system expects
										both win32 and linux-gtk builds to be in this directory. You can configure which eclipse builds are used as
										build targets / bundle targets in builders/product/build.properties, in the eclipse.builds property (available after customization).
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Location for build binaries</emphasis></entry>
								<entry>
									The entire build output hierarchy will be placed in this directory (ZIPs, build logs, etc). It is recommended that this be a directory other than where you checked out the releng project.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Location of a clean eclipse 3.1 installation (no external plugins)</emphasis></entry>
								<entry>
									The top level directory where a fresh extract of eclipse 3.1 lives. Note that this eclipse extract should be completely clean of external plugins.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Location of JBossIDE Releng Project Root</emphasis></entry>
								<entry>
									This is the top level directory of the jbosside releng project. If you ran the customizeBuild.xml ant script correctly, this should be automatically set correctly for you.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Location of SSH Private Key</emphasis></entry>
								<entry>
									The location of a ssh private key for publishing build results. Unless you are a JBossIDE developer, you should ignore this.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">SSH Passphrase</emphasis></entry>
								<entry>
									SSH passphrase for the selected private key. Unless you are a JBossIDE developer, you should ignore this.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Enable SCP Publishing?</emphasis></entry>
								<entry>
									Enable/Disable scp publishing of build zips and logs. Unless you are a JBossIDE developer, you should ignore this.
								</entry>
							</row>
							<row>
								<entry><emphasis role="bold">Enable Emal Notification?</emphasis></entry>
								<entry>
									Enable/Disable email notification. Unless you are a JBossIDE developer, you should ignore this.
								</entry>
							</row>
						</tbody>
					</tgroup>
				</informaltable>
				
				<para>After filling out all the fields, you can click "Next>" and the customization process will finish.</para>
			</listitem>
		</itemizedlist>
	</section>
	
	<section id="properties-customization">
		<title>Properties-file Customization (sysadmins, cruisecontrol)</title>
		
		<para>Start by copying customize.properties.example to customize.properties. After it's copied, let's open it up and take a look at each property and what it means.</para>
		
		<informaltable>
			<tgroup cols="2" align="left" valign="top" colsep="0" rowsep="0">
				<tbody>
					<row>
						<entry><emphasis role="bold">eclipse.archive.path</emphasis></entry>
						<entry>This should be a directory where the various binary zip distributions of eclipse live. By default, the build system expects
								both win32 and linux-gtk builds to be in this directory. You can configure which eclipse builds are used as
								build targets / bundle targets in builders/product/build.properties, in the eclipse.builds property (available after customization).
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">build.output.directory</emphasis></entry>
						<entry>
							The entire build output hierarchy will be placed in this directory (ZIPs, build logs, etc). It is recommended that this be a directory other than where you checked out the releng project.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">clean.eclipse.home</emphasis></entry>
						<entry>
							The top level directory where a fresh extract of eclipse 3.1 lives. Note that this eclipse extract should be completely clean of external plugins.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">releng.root</emphasis></entry>
						<entry>
							This is the top level directory of the jbosside releng project. If you ran the customizeBuild.xml ant script correctly, this should be automatically set correctly for you.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">ssh.key</emphasis></entry>
						<entry>
							The location of a ssh private key for publishing build results. Unless you are a JBossIDE developer, you should ignore this.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">ssh.passphrase</emphasis></entry>
						<entry>
							SSH passphrase for the selected private key. Unless you are a JBossIDE developer, you should ignore this.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">enable.publishing</emphasis></entry>
						<entry>
							Enable/Disable scp publishing of build zips and logs. Should be true or false.  Unless you are a JBossIDE developer, you should ignore this.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">enable.notification</emphasis></entry>
						<entry>
							Enable/Disable email notification. Should be true or false. Unless you are a JBossIDE developer, you should ignore this.
						</entry>
					</row>
					<row>
						<entry><emphasis role="bold">build.script.ext</emphasis></entry>
						<entry>
							Build script extension for this platform. Should be "bat" or "sh". (No quotes)
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
			
		<para>After setting the properties, you will need to run the customizeBuild.xml ant script, and call the target "customize", like so:</para>
		<programlisting>ant -f customizeBuild.xml customize</programlisting>
	</section>
</chapter>