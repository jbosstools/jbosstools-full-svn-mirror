<project default="jbosside-docs-build">
	<property name="cvs-tag" value="HEAD"/>
	<property name="output-dir" value="${basedir}/docs"/>
	<property name="install-dir" value="${output-dir}/jbosside/core/docs/user/install"/>
	<property name="tutorial-dir" value="${output-dir}/jbosside/core/docs/user/tutorial"/>
	<property name="docbook-support-dir" value="${output-dir}/jbosside/core/docbook-support"/>
	
	<target name="checkout-docs">	
		<mkdir dir="docs"/>
		
		<cvs cvsroot=":pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss"
			package="jbosside/core/docs/user/common" dest="docs"  tag="${cvs-tag}"/>
		
		<cvs cvsroot=":pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss"
			package="jbosside/core/docs/user/install" dest="docs"  tag="${cvs-tag}"/>
		
		<cvs cvsroot=":pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss"
			package="jbosside/core/docs/user/tutorial" dest="docs"  tag="${cvs-tag}"/>
	</target>
	
	<target name="build-docs">
		<property name="docbook-support" value="${docbook-support-dir}/support.xml"/>
		
		<ant dir="${install-dir}" antfile="${docbook-support}" target="lang.dochtml">
			<property name="lang" value="en"/>
			<property name="build.dir" value="${output-dir}/build/install"/>
		</ant>
		<ant dir="${tutorial-dir}" antfile="${docbook-support}" target="lang.dochtml">
			<property name="lang" value="en"/>
			<property name="build.dir" value="${output-dir}/build/tutorial"/>
		</ant>
	</target>
	
	<target name="build-toc">
		<style basedir="${install-dir}/en" destdir="${install-dir}/en" style="eclipse-docbook-toc.xsl" includes="master.xml" extension=".toc.xml" force="true">
			<param name="build-dir" expression="install"/>
			<param name="label" expression="JBoss Eclipse IDE Installation Guide"/>
		</style>
		<style basedir="${tutorial-dir}/en" destdir="${tutorial-dir}/en" style="eclipse-docbook-toc.xsl" includes="master.xml" extension=".toc.xml" force="true">
			<param name="build-dir" expression="tutorial"/>
			<param name="label" expression="JBoss Eclipse IDE Tutorial"/>
		</style>
		<move file="${install-dir}/en/master.toc.xml" tofile="install-toc.xml"/>
		<move file="${tutorial-dir}/en/master.toc.xml" tofile="tutorial-toc.xml"/>
	</target>
	
	<target name="build-zip">
		<zip destfile="doc.zip">
			<fileset dir="docs/build">
				<include name="install/**/*"/>
				<include name="tutorial/**/*"/>
			</fileset>
		</zip>
	</target>
	
	<target name="clean-docs">
		<delete includeemptydirs="true">
			<fileset dir="docs" defaultexcludes="false">
				<include name="**/*"/>
			</fileset>
		</delete>
	</target>
	
	<target name="jbosside-docs-build" depends="checkout-docs,build-docs,build-toc,build-zip,clean-docs"/>
	
</project>