<chapter id="servlet.file.generation">
	<title>Generation of the Servlet related files</title>
	
	<para>To generate the Web descriptors, we need to create another XDoclet configuration, like we did for our EJB. </para>
	
	<informaltable frame="none">
	<tgroup cols="2" align="left" colsep="1" rowsep="1">
		<tbody>
			<row>
				<entry>
				<procedure>
					<title>XDoclet Web Configuration Creation</title>
					<step>Edit the project properties. Right-click on the project and select <literal>Properties</literal>.</step>
					<step>In the properties page, select <literal>XDoclet Configurations</literal>.</step>
					<step>Right-click in the top area to pop-up the menu and choose <literal>Add</literal>. Type <literal>Web</literal> in the dialog and click <literal>OK</literal>.</step>
				</procedure>
				<para>
					You have created a new generation configuration named <literal>Web</literal>.
				</para>
				</entry>
				<entry>
		            <mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-web-config-1.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
				<procedure>
					<title>Webdoclet Configuration</title>
					<step><para>Select the <literal>Web</literal> configuration.</para></step>
					<step><para>In the lower-left area, right-click to popup the menu and choose <literal>Add Doclet</literal>.</para></step>
					<step><para>A list of available doclets will appear. Choose <literal>webdoclet</literal> and click <literal>OK</literal>.</para></step>
					<step><para>On the lower-right area, you see the properties of the <literal>ejbdoclet</literal>.</para>
						<substeps>
							<step>Set the <literal>destDir</literal> property to <literal>src/WEB-INF</literal>.</step>
						</substeps>
					</step>
				</procedure>
				<para>
					Our configuration now contains a <literal>webdoclet</literal> that will produce files in the <literal>src/WEB-INF</literal> folder.
				</para>
				</entry>
				<entry>
		            <mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-web-config-2.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<procedure>
					<title>Fileset Configuration</title>
					<step>In the lower-left area, right-click on <literal>webdoclet</literal> to popup the menu and choose <literal>Add</literal>.</step>
					<step>A list of available subtasks will appear. Choose <literal>fileset</literal> and click <literal>Ok</literal>.</step>
					<step>On the lower-right area, you see the properties of the fileset.
						<substeps>
							<step>Set the <literal>dir</literal> property to <literal>src</literal>.</step>
							<step>Uncheck <literal>excludes</literal></step>
							<step>Set the <literal>includes</literal> property to <literal>**/*Servlet.java</literal>.</step>
						</substeps>
					</step>
					</procedure>
					<para>Our configuration now contains a <literal>webdoclet</literal> with a <literal>fileset</literal> that contains the <literal>src</literal> directory, and all files under it that end in <literal>Servlet.java</literal>.</para>
				</entry>
				<entry>
		            <mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-web-config-3.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<procedure>
						<title>Deployment Descriptor Configuration</title>
						<step>Add a new <literal>deploymentdescriptor</literal> subtask to the <literal>webdoclet</literal> (see above).
						<substeps>
							<step>Set the <literal>Servletspec</literal> property to <literal>2.3</literal>.</step>
						</substeps>
						</step>
					</procedure>
					<para>All of the standard Web deployment descriptors will now be placed in the <literal>src/WEB-INF</literal> directory (property is inherited from <literal>webdoclet</literal>).</para>
				</entry>
				<entry>
					<mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-web-config-4.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<procedure>
						<title>JBoss Configuration</title>
						<step>Add a new <literal>jbosswebxml</literal> subtask to the <literal>webdoclet</literal> (see above).
						<substeps>
							<step>Set the <literal>Version</literal> property to <literal>3.0</literal>.</step>
						</substeps>
						</step>
					</procedure>
					<para>All of the JBoss-specific Web deployment descriptors will now be placed in the <literal>src/WEB-INF</literal> directory (property is inherited from <literal>webdoclet</literal>).</para>
				</entry>
				<entry>
					<mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-web-config-5.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<para>Click <literal>OK</literal> and the XDoclet configuration for the <literal>Tutorial</literal> will be saved.
					Once the configuration is saved, right-click on the <literal>Tutorial</literal> project and select <literal>Run XDoclet</literal>.
					The XDoclet generation will display its output in the console. The output should look like this:</para>
				</entry>
				<entry>
					<mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/xdoclet-run-2.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<para>
						After the generation, you should have a project that looks like this.
						Note that a <literal>WEB-INF</literal> folder has been created with the web deployment descriptors (both standard and jboss).
					</para>
				</entry>
				<entry>
					<mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/project-after-xdoclet-2.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
			<row>
				<entry>
					<para>
						In order to run our servlet, we'll need to create an HTML page that passes it parameters.
					</para>
					<procedure>
						<title>Creating the HTML Page</title>
						<step>Create a <literal>docroot</literal> folder under the root of the project.</step>
						<step>Create an empty file named <literal>index.html</literal> under the <literal>docroot</literal> folder.</step>
					</procedure>
					<para>
						The <literal>index.html</literal> file is intended to be the default page for the Web application and contains a form that will be posted to the Servlet.
					</para>
				</entry>
				<entry>
					<mediaobject>
		                <imageobject>
		                    <imagedata align="center" fileref="images/project-after-html.jpg"/>
		                </imageobject>
		            </mediaobject>
				</entry>
			</row>
		</tbody>
	</tgroup>
	</informaltable>
	
	<para>
		The following content should be copied into the <literal>index.html</literal> file:
	</para>
	<programlisting><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <title>
         Fibonacci Application
      </title>
   </head>
   <body>
      <h1>Fibonacci Form</h1>
      <form action="Compute" method="POST" >
         <table cellspacing="2" cellpadding="2" border="0">
            <tr>
               <td>
                  Limit :
               </td>
               <td>
                  <input type="text" name="limit" value="50">
               </td>
            </tr>
            <tr>
               <td>
                  <input type="submit" name="Compute" value="Compute">
               </td>
               <td>
                  <input type="Reset">
               </td>
            </tr>
         </table>
      </form>
   </body>
</html>
	]]>
	</programlisting>
</chapter>