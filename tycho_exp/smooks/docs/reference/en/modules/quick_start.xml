<?xml version="1.0" encoding="UTF-8"?>
<chapter id="quickstart" xreflabel="Quick Start" role="updated">
	<?dbhtml filename="quick_start.html"?>
	<chapterinfo>
		<keywordset>
			<keyword>JBoss Tools</keyword>
			<keyword>Smooks</keyword>
			<keyword>JBDS</keyword>
			<keyword>java</keyword>
		</keywordset>
	</chapterinfo>
	<title>Quick Start</title>
	<para> This "Quick Start" will show how to use the <property>Smooks tools</property> to create/edit the Smooks
		configuration file for Java2Java data transformation.</para>
	<para> This chapter gives you a brief understanding of the <property>Smooks tools</property>.</para>
	<section>
		<title>Download Smooks Java-to-Java Example</title>
		<para> Visit <ulink
			url="http://www.blogjava.net/Files/reloadcn/smooks_java_java.zip"
			>smooks examples page</ulink> to download the "java-to-java" example project. </para>
		<tip>
			<title>Tip:</title>

			<para> The example project is based on Maven, we suggest you to create a new eclipse
				Java project, copy the example code and .jar files from the example project and paste
				them into the eclipse Java project. </para>
		</tip>
	</section>
	<section>
		<title>Mapping rules</title>
		<para>At the begining of working with Smooks tools,
			we need to understand the Java-to-Java mapping rules of this example.
			The transform input Java class is <emphasis><property>example.sourcemodel.Order</property></emphasis> , its structure looks like this :
		</para>
		<figure>
			<title>Order class</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/sourcemodel_structured.jpg" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>Let's describe the structure of <emphasis><property>example.sourcemodel.Order</property></emphasis> in short:</para>
		<itemizedlist>
			<listitem><para>Order class contains a <property>Header</property> class and a <property>List</property> class.</para></listitem>
			<listitem><para>The  <property>Header</property> class has <property>customerName</property>,<property>customerNumber</property>,<property>priority</property> as properties.</para></listitem>
			<listitem><para>In Order class the objects of the OrderItem class are stored in the List.</para></listitem>
			<listitem><para>OrderItem has <property>price</property>,<property>productId</property>,<property>quantity</property> as its properties.</para></listitem>
		</itemizedlist>
		<para>Let's look at the transform target Java class : <emphasis><property>LineOrder</property></emphasis>.</para>
		<para>On the screen below you can see its structure:</para>
		<figure>
			<title>LineOrder class</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/targetmodel_structured.jpg" />
				</imageobject>
			</mediaobject>
		</figure>
		<itemizedlist>
			<listitem><para><property>LineOrder</property> class contains 3 properties:<property>customerId</property>,<property>customerName</property>,<property>priority</property> and an array of lineItems.</para></listitem>
			<listitem><para>The <property>Header</property> class has <property>customerName</property>,<property>customerNumber</property>,<property>priority</property> as its properties.</para></listitem>
			<listitem><para>OrderItem objects are stored in a List.</para></listitem>
		</itemizedlist>
		<para>Now it's the time to define the mapping rules to transform the input source java class to the target java class:</para>
		<itemizedlist>
			<listitem><para>Each instance of the Order class should be mapped with an instance of the LineOrder class.</para></listitem>
			<listitem><para>The value of <property>customerName</property> of the Header class should be assigned to the <property>customerName</property> property of a LineOrder instance.</para></listitem>
			<listitem><para>The value of <property>customerNumber</property> of the Header class should be assigned to the <property>customerId</property> property of a LineOrder instance.</para></listitem>
			<listitem><para>The value of <property>priority</property> of the Header class should be assigned to the <property>priority</property> property of LineOrder instance.</para></listitem>
			<listitem><para>For the <property>orderitems</property> List of the Order instance, it's necessary to map a new lineItems array instance of LineOrder ,
			and each OrderItem instance in the orderItems List should be transformed to a LineItem instance,
			those instances will be put into the lineItems array.</para></listitem>
			<listitem><para>The value of <property>productId</property> of the OrderItem instance should be assigned to the 'productCode' of LineItem.</para></listitem>
			<listitem><para>The value of <property>price</property> of  OrderItem should be assigned to the <property>unitPrice</property> of LineItem.</para></listitem>
			
		</itemizedlist>
	</section>
	
	<section id="config_file_wizzard">
		<title>Smooks Configuration File Wizard</title>
		<para>Select the Smooks Java-to-Java example project that you created and right-click,
			select the menu <emphasis><property>New > Other</property>,</emphasis> then find
					<emphasis><property>Smooks > Smooks Configuration File</property>.</emphasis>
			Click the <emphasis>
				<property>Next</property>
			</emphasis> button. </para>
		<figure>
			<title>Selecting Smooks Configuration File Wizard</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start1.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>The first wizard page is a file path creation page. Select the <emphasis>
				<property>src</property>
			</emphasis> folder to be the files container, and input the name
					<emphasis><property>smooks-config.xml</property>.</emphasis> Click
					<emphasis><property>Next</property>.</emphasis></para>
		<figure>
			<title>Choosing the configuration file container and the file name</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start2.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>The second wizard page is a Smooks configuration file version choose page.Select appropriate one and click <emphasis><property>Finish</property></emphasis>.</para>
		<!--<para> As the quick start introduces how to create/edit the Java-to-Java Smooks
			configuration file, let&apos;s select the<emphasis>
				<property>Java-to-Java</property>
			</emphasis> type as the source/target transform data type. </para>

		<figure>
			<title>Selecting Data Type</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start3.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para>On the next page you are prompted to choose the source data for transformation.
			Let&apos;s select the <property>Order</property> class from the example project as
			the source JavaBean class.</para>

		<figure>
			<title>Selecting the Source Data</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start4.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para>Then the wizard page asks you to choose the target data for transformation. We select
			the <property>ListOrder</property> class as the target JavaBean class.</para>
		<figure>
			<title>Selecting the Target Data</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start5.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para/>

		<tip>
			<title>Tip:</title>
			<para>You can omit two these steps and just press
					<emphasis><property>Finish</property>.</emphasis> This will open the empty
				Smooks Configuration file. It&apos;s possible to <link
					linkend="graphicaleditor_datalink">select source/target data</link> afterwards
				in the Smooks Graph editor.</para>
		</tip>-->
	</section>
	<section id="quickstart_formeditor">
		<title>Smooks Editor</title>

		<para>When all the wizard steps are passed, a new Smooks Configuration file is created and
			the <property>Smooks Configuration  Editor</property> will be opened automatically:</para>
		<figure>
			<title>Smooks Editor</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start6.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>On the bottom of this editor there are 5  tabs, they are :
			
			Overview, Reader, Message Filter, Graph, Source.</para>
		<section id="graphicaleditor_datalink">
			<title>Adding the input data</title>
			<para>At first, we need to add the Order class as the input data.
				To do this, click the Reader tab, swich to the Reader/Input editor page</para>
			
		<!--<para> This editor contains several parts: <table>
				<title>The Smooks Editor Parts</title>
				<tgroup cols="2">

					<colspec colnum="1" align="left" colwidth="1*"/>
					<colspec colnum="2" colwidth="5*"/>

					<thead>
						<row>
							<entry>Editor feature</entry>
							<entry>Functionality</entry>
						</row>
					</thead>

					<tbody>

						<row>
							<entry>
								<para>Problems area</para>
							</entry>
							<entry>
								<para>If there are any errors when you are editing the file, the
									Problems area displays them</para>
							</entry>
						</row>

						<row>
							<entry>
								<para>Source data tree</para>
							</entry>
							<entry>
								<para>The tree displays a structure of the transformed source
									data</para>
							</entry>
						</row>

						<row>
							<entry>
								<para>Target data tree</para>
							</entry>
							<entry>
								<para>The tree displays a structure of the transformed target
									data</para>
							</entry>
						</row>

						<row>
							<entry>
								<para>Mapping graphical area</para>
							</entry>
							<entry>
								<para>Show the data mapping connection lines</para>
							</entry>
						</row>

						<row>
							<entry>
								<para>Source/Target data selection links</para>
							</entry>
							<entry>
								<para>Click the link, and <link linkend="graphicaleditor_datalink"
										>Data Selection wizard</link> is opened helping you to
									choose the source/target data</para>
							</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</para>-->
	

		<para>To choose the transform data you should open <emphasis>
			<property>Reader</property></emphasis> tab and click <emphasis>
			<property>Add</property></emphasis> button in the Input Data section.</para>
		<figure>
			<title>Input Data section</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start_6a.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>After clicking the button the <property>Data Type Selection wizard</property> is
			opened, and there are many data types in the list: Java, XML etc.</para>
		<note>
			<title>Note</title>
			<para> There will become more and more data types on the list as the development goes on.
			</para>
		</note>

		<figure>
			<title>Data Type Wizard</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start7.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para>Select the <emphasis>
				<property>Java</property>
			</emphasis> data type and click <emphasis><property>Next</property>,</emphasis> you will
			see the JavaBean class selection page:</para>

		<figure>
			<title>JavaBean Data Selection</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start8.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para> Let's select the Order class from the example project as the source JavaBean class.After that click <emphasis>
				<property>Finish</property>
			</emphasis> and you should see the just added java class,  being displayed in the Input Data Section.
			</para>
		<figure>
			<title>Displaying the Structure of the Transformed Data</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start9.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		</section>
		<section>
			<title>Adding the target Bean</title>
			<para>After adding the input data, let's switch to the Message Filter page:</para>
			<figure>
				<title>Displaying the Structure of the Transformed Data</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/quick_start/quick_start9a.png" scale="90"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>Click the <property>Add</property> button, the <property>Add Child</property> wizard page will be shown, let's select the <property>Java Binding v1.2 -> Bean v1.2</property> and click <emphasis><property>OK</property></emphasis> to add the Bean :
			</para>
			<figure>
				<title>Add Child wizard</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/quick_start/quick_start9b.png" scale="90"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>Then we can find on the Message Filter page the <property>Bean v1.2</property> item  added, click on it ,a Bean v1.2 section should appear to the right of the page.
				The section represents a GUI for editing <property>Bean v1.2</property> properties:</para>
			<figure>
				<title>Bean v1.2 section</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/quick_start/quick_start9c.png" scale="90"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>You should input <property>
				lineOrder</property> as the Bean's id in the "Bean Id" field.Then you should click  <property>Browse</property> button
				near the <property>Class</property> textfield and select LineOrder as the Bean's class.</para>
			<note>
				<para>
					When you enter a value for the <property>Class</property> text field,
					you can type 'Alt + /' and the content assist pop dialog will be shown,
					so it's will increase the efficiency. If 'Alt + /' doesn't work,
					try to use the 'Ctrl + space'('Key Assist' of Eclipse).
				</para>
			</note>
			<para>Let's click the <property>Add Binding</property> link at the bottom of this page,
				it will show a dialog to ask the binding of what Bean properties you will prefer to add.
				Select all and click OK, you will see a list of Binding elements added under the Bean item.</para>
			<para>Then you should add an array of beans called <property>lineItems</property> and a Bean LineItem.These two classes and Id values are:</para>
			<para>Array Bean:</para>
				<itemizedlist>
					<listitem><para>BeanId : lineItems;</para></listitem>
					<listitem><para>Class : example.trgmodel.LineItem[]</para></listitem>
				</itemizedlist>
			<para>LineItem Bean :</para>
			<itemizedlist>
				<listitem><para>BeanId : lineItem;</para></listitem>
				<listitem><para>Class : example.trgmodel.LineItem</para></listitem>
			</itemizedlist>
		<note>
			<para>
				In Smooks , to be an array of Beans , the class value should end with '[]'. This means that this bean is an array type.
	
			</para>
		</note>
			<para>To finish this work, use the <property>Add Binding</property> link to add  all the bindings for the Bean.</para>
		</section>
	
		
	</section>
	<section id="quickstart_mapping">
		<title>Mapping</title>


		<para>How to map the java class just added?</para>
		
		<para>First, you should know what to transform:</para>

		<orderedlist numeration="loweralpha" inheritnum="inherit">
			<listitem>
				<para>Bind the <emphasis>
						<property>&quot;customerName&quot;</property>
					</emphasis> property of the <property>Order#header</property> to the <emphasis>
						<property>&quot;customerName&quot;</property>
					</emphasis> property of <property>LineOrder</property>.</para>
			</listitem>
			<listitem>
				<para>Bind the <emphasis>
						<property>&quot;customerNumber&quot;</property>
					</emphasis> property of the <property>Order#header</property> to the <emphasis>
						<property>&quot;customerId&quot;</property>
					</emphasis> property of <property>LineOrder</property>.</para>
			</listitem>
			<listitem>
				<para>Bind the <emphasis>
						<property>&quot;price&quot;</property>
					</emphasis> property of the <property>OrderItem</property> to the <emphasis>
						<property>&quot;unitPrice&quot;</property>
					</emphasis> property of <property>LineItem</property>.</para>
			</listitem>
			<listitem>
				<para>Bind the <emphasis>
						<property>&quot;productId&quot;</property>
					</emphasis> property of the <property>OrderItem</property> to the <emphasis>
						<property>&quot;productCode&quot;</property>
					</emphasis> property of <property>LineItem</property>.</para>
			</listitem>
			<listitem>
				<para>Bind the <emphasis>
						<property>&quot;quantity&quot;</property>
					</emphasis> property of the <property>OrderItem</property> to the <emphasis>
						<property>&quot;unitQuantity&quot;</property>
					</emphasis> property of <property>LineItem</property>.</para>
			</listitem>
		</orderedlist>

		<para> Make sense?
			You should open Design tab and click Add button. In opened Add Child Wizard,please, select <emphasis>
				<property>Add Smooks Resource>Java Binding>Bindings</property></emphasis>.  
			</para>
		<para>First of all, you should bind <emphasis>
			<property>Order</property></emphasis> to <emphasis>
				<property>LineOrder</property></emphasis>. To do this one <emphasis>
					<property>Bindings</property></emphasis> Item should be added to the Resource List.</para>
			<figure>
				<title>Mapping</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/quick_start/quick_start10.png" scale="90"/>
					</imageobject>
				</mediaobject>
			</figure><para>Click on it and you should see <emphasis>
				<property>Bindings</property></emphasis> Section to the right of <emphasis>
					<property>Message Filtering Resources</property></emphasis>.Write <emphasis> <property>lineOrder</property></emphasis> in the <emphasis>
						<property>Bean id</property></emphasis> field.</para>
		<para>Select <emphasis>
			<property>example.trgmodel.LineOrder</property></emphasis> in the <emphasis>
				<property>Class</property></emphasis> field and <emphasis>
					<property>example.srcmodel.Order</property></emphasis> in the <emphasis>
						<property>Name</property></emphasis> field.Your <emphasis> <property>Smooks Configuration Editor</property></emphasis> should look like this: </para>
		<figure>
			<title>Mapping</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start11.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		
		<para>Now you should bind two values <emphasis> <property>&quot;customerNumber&quot;</property>
		</emphasis> property of the <property>Order#header</property> to the <emphasis>
			<property>&quot;customerId&quot;</property>
		</emphasis> property of <property>LineOrder</property>.To do this  right click your just created <emphasis>
			<property>Bindings Item >Add Smooks Resource>Value</property></emphasis>
		.</para>
		
		<figure>
			<title> Mapping Editor</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start12.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure><note>
			<title>Note:</title>
			<para>Please, remember that the root nodes of the source data and target data *MUST* be
				connected.</para>
			<para>This rule is not only for Java-to-Java, but also is relevant for
				XML-to-Java </para>
		</note>
		<para> Do the same operation with the 
		other properties in this and other classes.</para>
		<para>It's also  necessary to bind  <emphasis>
			<property>orderItems</property></emphasis> property of the <emphasis>
				<property>Order</property></emphasis> to <emphasis>
					<property>lineItems</property></emphasis> property of <emphasis>
						<property>LineOrder</property></emphasis>.The difference from the previous steps is that the  <emphasis>
							<property>orderItems</property></emphasis> is presented by the list of <emphasis>
								<property>Order</property></emphasis> and <emphasis>
									<property>lineItems</property></emphasis> is the massive of <emphasis>
										<property>LineItem</property></emphasis> .To do the binding,you should use <emphasis>
										<property>Wiring Item</property></emphasis>.First you should create a new Binding item.   This is a configuration that allows you to construct an object graph .Select <emphasis>
												<property>example.trgmodel.LineItem[]</property></emphasis> in the Class field and orderItems in the Name field,in bean Id write lineItems.
			Your Smooks Configuration Editor should look like this: 
		</para>
		<figure>
			<title> Creating Wiring Item</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start13a.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para> Then you should right click <emphasis>
			<property>lineOrder</property></emphasis> binding item<emphasis>
				<property>>Add Smooks Resource>Wiring</property></emphasis>.Select <emphasis>
					<property>lineItem</property></emphasis> in <emphasis>
						<property>Bean id Ref</property></emphasis>.
		</para>
		<para>The final step is to add new Wiring item to lineOrder <property>Binding</property>.In the <property>Bean id Ref</property> select <emphasis>
			<property>lineItems</property></emphasis> and in <emphasis>
				<property>Property</property></emphasis> select <emphasis>
			<property>lineItems</property></emphasis>.</para>
<!--
		<para>Next, you are going to bind the properties of the <property>OrderItem</property> to
			the properties of the <property>LineItem</property>.</paa>
		<para>Select the <emphasis>
				<property>&quot;price&quot;</property>
			</emphasis> and drag it onto the <emphasis>
				<property>&quot;unitPrice&quot;</property>
			</emphasis> of the other side tree viewer. The Problems area shows an
			error:</para>
		<figure>
			<title>Connection Error 1</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start12.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>How to deal with the error?</para>
		<para>Please click the <emphasis>
			<property>Fix it</property></emphasis> link, a menu is popped-up with several
			resolve methods on it.</para>
		<figure>
			<title>Fixing the Connection Error</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start13.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para> Select the first resolve method: <emphasis>
			'Connect the &quot;OrderItem&quot; to the
			&quot;LineItem&quot; '.</emphasis> As the result the <emphasis>
				<property>&quot;OrderItem&quot;</property></emphasis> is connected with
			the <emphasis>
				<property>&quot;LineItem&quot;</property>.</emphasis></para>
		<para>But the notify message area still shows some other errors:</para>
		<figure>
			<title>Connection Error 2</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start14.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>
		<para>OK, let&apos;s deal with the fire error. Click the <emphasis>
			<property>Fix it</property></emphasis> link and
			select the first resolve method. The <emphasis>
				<property>&quot;orderItems&quot;</property></emphasis> is connected with
			the <emphasis>
				<property>&quot;lineItems&quot;</property>.</emphasis></para>
		
		<tip>
			<title>Tip:</title>
			<para> Why does the error occur?</para>
			<para> You will find that, if you only connect the property node without connecting the
				parent node of the property, the &quot;connection error&quot; occurs.</para>
			<para>The connection of the &quot;price-to-unitPrice&quot; is the
				&quot;Binding Connection&quot;, but it needs an &quot;Instance Creation
				Connection&quot; - the connection of the
				&quot;OrderItem-to-LineItem&quot;.</para>
		</tip>
		<para> After that, connect <emphasis>
			<property>&quot;quantity&quot;</property></emphasis> to the <emphasis>
				<property>&quot;unitQuantity&quot;</property></emphasis> and <emphasis>
					<property>&quot;productId&quot;</property></emphasis> to the
			<emphasis>
				<property>&quot;productCode&quot;</property>:</emphasis></para>
		<figure>
			<title>Complete Mapping</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/quick_start/quick_start15.png" scale="90"/>
				</imageobject>
			</mediaobject>
		</figure>-->
		<para>Now, you should save the file and the <property>Smooks tools</property> generate the correct
			configuration file content.</para>
		<para>OK, let run the test class: <property>example.Main</property>. (Please, make sure that the Smooks engine
			loads the correct configuration file).</para>
		<para>Success!</para>
	</section>
</chapter>
