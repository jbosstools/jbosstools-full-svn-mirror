<project default="build.requirement">
	<loadproperties srcFile="build.properties"/>
	<taskdef classpath="../../lib/ant-contrib.jar" resource="net/sf/antcontrib/antlib.xml"/>

	<target name="build.requirement">
		<var name="script.extension" value="sh"/>
		<var name="jwsdp.executable" value="${jwsdp.unix.installer}"/>
		
		<if>
			<contains string="${os.name}" substring="Windows"/>
			<then>
				<var name="script.extension" value="bat"/>
				<var name="jwsdp.executable" value="${jwsdp.win32.installer}"/>
			</then>
		</if>
		
		<echo>extracting jwsdp into ${jwsdp.basedir}..</echo>
		<exec executable="${jwsdp.executable}">
			<arg line="-is:javahome ${java.home}"/>
			<arg line='-P installLocation="${jwsdp.basedir}"'/>
			<arg line="-silent"/>
		</exec>
				
		<propertyregex property="escaped.basedir"
			input="${basedir}"
			regexp="\\"
			replace="/"/>
		
		<echo file="return.properties">
			jwsdp.home=${escaped.basedir}/${jwsdp.basedir}
			jwsdp.xjcScriptName=xjc.${script.extension}
		</echo>
	</target>
</project>
