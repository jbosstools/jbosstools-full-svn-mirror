<project default="build.requirement">
		  <!--property name="requirement.root" value="C:/Code/jbosside-cvs/jbosside-build/requirements"/-->
	<property file="build.properties"/>
	
	<taskdef classpath="../../lib/ant-contrib.jar" resource="net/sf/antcontrib/antlib.xml"/>

	<target name="build.requirement" depends="checkout.hibernateext">
		<property name="hibernateext.root" value="${hibernateext.build.dir}/${hibernateext.cvs.module}"/>
		<property name="build.script" value="${hibernateext.root}/${hibernateext.build.script}"/>

		<if>
			<equals arg1="${buildScriptExt}" arg2="bat"/>
			<then>
				<exec executable="${build.script}" dir="${hibernateext.root}/console"/>
				<exec executable="${build.script}" dir="${hibernateext.root}/tools"/>
			</then>
			<else>
				<exec executable="chmod">
					<arg value="755" />
					<arg value="${build.script}"/>
				</exec>
				<exec executable="${build.script}" dir="${hibernateext.root}/console"/>
				<exec executable="${build.script}" dir="${hibernateext.root}/tools"/>
			</else>
		</if>
 		
 		<echo file="return.properties">
			hibernateext.base=${hibernateext.build.dir}/${hibernateext.cvs.module}
		</echo>
	</target>

	<target name="check.hibernateext.checkedout">
		<available file="${hibernateext.build.dir}/${hibernateext.cvs.module}" type="dir"
			property="hibernateext.checkedout"/>
	</target>

	<target name="checkout.hibernateext" depends="check.hibernateext.checkedout" unless="hibernateext.checkedout">
		<cvspass cvsroot="${hibernateext.cvs.root}" password="${hibernateext.cvs.password}"/>

		<for list="${hibernateext.cvs.submodules}" param="submodule">
			<sequential>
				<cvs cvsroot="${hibernateext.cvs.root}" package="${hibernateext.cvs.module}/@{submodule}" tag="${hibernateext.cvs.tag}" dest="${hibernateext.build.dir}" compression="true"/>
			</sequential>
		</for>
	</target>
</project>
